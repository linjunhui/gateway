package com.example.demov2;

import java.io.Serializable;
import java.nio.ByteBuffer;

public class Device implements Serializable {
	//4 字节
	int ip;
	//22 字节 最大7个汉字
	byte[] name = new byte[22];
	//9 字节
	byte[] id = new byte[9];
	//1 字节
	byte locked;
	//13 字节
	byte[] gateID = new byte[13];
	//1 字节
	byte online;
	// 22 * 10 = 220 字节 ，当然这个数值并没有220 字节，数值存的是引用
	Attr[] attrs = new Attr[10];
	//填充用
	byte[] next = new byte[4];
	public byte[] convertBytes() {
		//两个字节
		short msgtype = 0;
		
		ByteBuffer buffer=ByteBuffer.allocate(300);
		
		buffer.putShort(msgtype);
		buffer.putInt(this.ip);
		buffer.put(this.name);
		buffer.put(this.id);
		buffer.put(this.locked);
		buffer.put(this.gateID);
		buffer.put(this.online);
		
		for(int i = 0; i < attrs.length; i++) {
			byte[] bs = attrs[i].attrConvertBytes();
			buffer.put(bs);
		}
		
		System.out.println("put int :" + Integer.toHexString(buffer.get(0)) + buffer.get(1));
		
		byte[] bytes = buffer.array();
		return bytes;
		
	}

}

// 22 字节
 class Attr implements Serializable {
	//13字节
	byte[] attrName = new byte[13];
	//1 字节
	byte dataproperty;
	//4 字节
	int data;
	//4 字节
	int times;
	
	public byte[] attrConvertBytes() {
		ByteBuffer buffer=ByteBuffer.allocate(22);
		
		buffer.put(attrName);
		buffer.put(dataproperty);
		buffer.putInt(data);
		buffer.putInt(times);
		
		byte[] bytes = buffer.array();
		return bytes;
		
	}
}
 
 